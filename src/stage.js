
//Globalsç±»
Globals = {};

Globals.UNIT_SIZE = 32;
Globals.TILE_SIZE = Globals.UNIT_SIZE / 2;

Globals.CANVAS_WIDTH = Globals.UNIT_SIZE * 16;
Globals.CANVAS_HEIGHT = Globals.UNIT_SIZE * 14;



function StageMessage(stage) {
  this._stage = stage;
  this._visible = false;
}

StageMessage.prototype.show = function () {
  this._visible = true;
};

StageMessage.prototype.hide = function () {
  this._visible = false;
};

StageMessage.prototype.draw = function (ctx) {
  if (!this._visible) {
    return;
  }
  ctx.fillStyle = "black";
  ctx.fillText("STAGE " + ("" + this._stage).lpad(" ", 2), 195, 222);
};

//stage
Globals.stages = [];

// Stage 1
Globals.stages.push({
  map: "Base(224,400);SteelWall(208,416);SteelWall(208,400);SteelWall(208,384);SteelWall(224,384);SteelWall(240,384);SteelWall(256,384);SteelWall(256,400);SteelWall(256,416);BrickWall(64,368);BrickWall(80,368);BrickWall(64,384);BrickWall(80,384);BrickWall(64,336);BrickWall(80,336);BrickWall(64,352);BrickWall(80,352);BrickWall(64,304);BrickWall(80,304);BrickWall(64,320);BrickWall(80,320);BrickWall(128,304);BrickWall(144,304);BrickWall(128,320);BrickWall(144,320);BrickWall(128,336);BrickWall(144,336);BrickWall(128,352);BrickWall(144,352);BrickWall(128,368);BrickWall(144,368);BrickWall(128,384);BrickWall(144,384);BrickWall(192,304);BrickWall(208,304);BrickWall(192,320);BrickWall(208,320);BrickWall(192,272);BrickWall(208,272);BrickWall(192,288);BrickWall(208,288);BrickWall(224,272);BrickWall(240,272);BrickWall(224,288);BrickWall(240,288);BrickWall(256,272);BrickWall(272,272);BrickWall(256,288);BrickWall(272,288);BrickWall(256,304);BrickWall(272,304);BrickWall(256,320);BrickWall(272,320);BrickWall(320,368);BrickWall(336,368);BrickWall(320,384);BrickWall(336,384);BrickWall(320,336);BrickWall(336,336);BrickWall(320,352);BrickWall(336,352);BrickWall(320,304);BrickWall(336,304);BrickWall(320,320);BrickWall(336,320);BrickWall(384,304);BrickWall(400,304);BrickWall(384,320);BrickWall(400,320);BrickWall(384,336);BrickWall(400,336);BrickWall(384,352);BrickWall(400,352);BrickWall(384,368);BrickWall(400,368);BrickWall(384,384);BrickWall(400,384);BrickWall(192,336);BrickWall(208,336);BrickWall(256,336);BrickWall(272,336);BrickWall(128,288);BrickWall(144,288);BrickWall(64,288);BrickWall(80,288);BrickWall(320,288);BrickWall(336,288);BrickWall(384,288);BrickWall(400,288);BrickWall(256,256);BrickWall(272,256);BrickWall(192,256);BrickWall(208,256);SteelWall(32,240);SteelWall(48,240);SteelWall(416,240);SteelWall(432,240);BrickWall(352,240);BrickWall(368,240);BrickWall(320,240);BrickWall(336,240);BrickWall(96,240);BrickWall(112,240);BrickWall(128,240);BrickWall(144,240);BrickWall(32,224);BrickWall(48,224);BrickWall(96,224);BrickWall(112,224);BrickWall(128,224);BrickWall(144,224);BrickWall(320,224);BrickWall(336,224);BrickWall(352,224);BrickWall(368,224);BrickWall(416,224);BrickWall(432,224);BrickWall(192,208);BrickWall(208,208);BrickWall(256,208);BrickWall(272,208);BrickWall(256,192);BrickWall(272,192);BrickWall(192,192);BrickWall(208,192);BrickWall(128,176);BrickWall(144,176);BrickWall(64,176);BrickWall(80,176);BrickWall(320,176);BrickWall(336,176);BrickWall(384,176);BrickWall(400,176);BrickWall(256,144);BrickWall(272,144);BrickWall(192,144);BrickWall(208,144);BrickWall(128,144);BrickWall(144,144);BrickWall(128,160);BrickWall(144,160);BrickWall(64,144);BrickWall(80,144);BrickWall(64,160);BrickWall(80,160);BrickWall(64,112);BrickWall(80,112);BrickWall(64,128);BrickWall(80,128);BrickWall(64,80);BrickWall(80,80);BrickWall(64,96);BrickWall(80,96);BrickWall(64,48);BrickWall(80,48);BrickWall(64,64);BrickWall(80,64);BrickWall(128,48);BrickWall(144,48);BrickWall(128,64);BrickWall(144,64);BrickWall(128,80);BrickWall(144,80);BrickWall(128,96);BrickWall(144,96);BrickWall(128,112);BrickWall(144,112);BrickWall(128,128);BrickWall(144,128);BrickWall(192,112);BrickWall(208,112);BrickWall(192,128);BrickWall(208,128);BrickWall(192,80);BrickWall(208,80);BrickWall(192,96);BrickWall(208,96);BrickWall(192,48);BrickWall(208,48);BrickWall(192,64);BrickWall(208,64);BrickWall(256,48);BrickWall(272,48);BrickWall(256,64);BrickWall(272,64);BrickWall(256,80);BrickWall(272,80);BrickWall(256,96);BrickWall(272,96);BrickWall(256,112);BrickWall(272,112);BrickWall(256,128);BrickWall(272,128);BrickWall(320,144);BrickWall(336,144);BrickWall(320,160);BrickWall(336,160);BrickWall(320,112);BrickWall(336,112);BrickWall(320,128);BrickWall(336,128);BrickWall(320,80);BrickWall(336,80);BrickWall(320,96);BrickWall(336,96);BrickWall(320,48);BrickWall(336,48);BrickWall(320,64);BrickWall(336,64);BrickWall(384,48);BrickWall(400,48);BrickWall(384,64);BrickWall(400,64);BrickWall(384,80);BrickWall(400,80);BrickWall(384,96);BrickWall(400,96);BrickWall(384,112);BrickWall(400,112);BrickWall(384,128);BrickWall(400,128);BrickWall(384,144);BrickWall(400,144);BrickWall(384,160);BrickWall(400,160);SteelWall(224,112);SteelWall(240,112);SteelWall(224,128);SteelWall(240,128)",
  tanks: [
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
  ]
});

// Stage 2
Globals.stages.push({
  map: "Base(224,400);SteelWall(208,416);SteelWall(208,400);SteelWall(208,384);SteelWall(224,384);SteelWall(240,384);SteelWall(256,384);SteelWall(256,400);SteelWall(256,416);BrickWall(64,48);BrickWall(80,48);BrickWall(64,64);BrickWall(80,64);BrickWall(64,80);BrickWall(80,80);BrickWall(64,96);BrickWall(80,96);Trees(32,144);Trees(32,176);Trees(64,176);BrickWall(64,208);BrickWall(80,208);BrickWall(64,224);BrickWall(80,224);BrickWall(96,208);BrickWall(112,208);BrickWall(96,224);BrickWall(112,224);BrickWall(128,208);BrickWall(144,208);BrickWall(128,224);BrickWall(144,224);BrickWall(64,272);BrickWall(80,272);BrickWall(64,288);BrickWall(80,288);BrickWall(64,304);BrickWall(80,304);BrickWall(64,320);BrickWall(80,320);BrickWall(64,336);BrickWall(80,336);BrickWall(64,352);BrickWall(80,352);BrickWall(64,368);BrickWall(80,368);BrickWall(64,384);BrickWall(80,384);BrickWall(64,400);BrickWall(80,400);BrickWall(64,416);BrickWall(80,416);SteelWall(32,272);SteelWall(48,272);SteelWall(32,288);SteelWall(48,288);SteelWall(128,48);SteelWall(144,48);SteelWall(128,64);SteelWall(144,64);SteelWall(128,16);SteelWall(144,16);SteelWall(128,32);SteelWall(144,32);BrickWall(128,112);BrickWall(144,112);BrickWall(128,128);BrickWall(144,128);BrickWall(128,144);BrickWall(144,144);BrickWall(128,160);BrickWall(144,160);BrickWall(192,176);BrickWall(208,176);BrickWall(192,192);BrickWall(208,192);Trees(160,208);Trees(192,208);Trees(224,208);Trees(160,240);SteelWall(128,240);SteelWall(144,240);SteelWall(128,256);SteelWall(144,256);SteelWall(128,272);SteelWall(144,272);SteelWall(128,288);SteelWall(144,288);BrickWall(128,304);BrickWall(144,304);BrickWall(128,320);BrickWall(144,320);BrickWall(128,336);BrickWall(144,336);BrickWall(128,352);BrickWall(144,352);BrickWall(128,400);BrickWall(144,400);BrickWall(128,416);BrickWall(144,416);BrickWall(192,336);BrickWall(208,336);BrickWall(192,352);BrickWall(208,352);BrickWall(224,336);BrickWall(240,336);BrickWall(224,352);BrickWall(240,352);BrickWall(256,336);BrickWall(272,336);BrickWall(256,352);BrickWall(272,352);BrickWall(256,304);BrickWall(272,304);BrickWall(256,320);BrickWall(272,320);BrickWall(224,304);BrickWall(240,304);BrickWall(224,320);BrickWall(240,320);BrickWall(192,304);BrickWall(208,304);BrickWall(192,320);BrickWall(208,320);BrickWall(192,272);BrickWall(208,272);BrickWall(192,288);BrickWall(208,288);BrickWall(192,240);BrickWall(208,240);BrickWall(192,256);BrickWall(208,256);BrickWall(256,240);BrickWall(272,240);BrickWall(256,256);BrickWall(272,256);BrickWall(256,272);BrickWall(272,272);BrickWall(256,288);BrickWall(272,288);SteelWall(256,208);SteelWall(272,208);SteelWall(256,224);SteelWall(272,224);SteelWall(288,176);SteelWall(304,176);SteelWall(288,192);SteelWall(304,192);SteelWall(224,144);SteelWall(240,144);SteelWall(224,160);SteelWall(240,160);SteelWall(256,16);SteelWall(272,16);SteelWall(256,32);SteelWall(272,32);BrickWall(256,48);BrickWall(272,48);BrickWall(256,64);BrickWall(272,64);BrickWall(256,80);BrickWall(272,80);BrickWall(256,96);BrickWall(272,96);BrickWall(224,80);BrickWall(240,80);BrickWall(224,96);BrickWall(240,96);BrickWall(320,80);BrickWall(336,80);BrickWall(320,96);BrickWall(336,96);BrickWall(320,48);BrickWall(336,48);BrickWall(320,64);BrickWall(336,64);SteelWall(352,80);SteelWall(368,80);SteelWall(352,96);SteelWall(368,96);SteelWall(320,112);SteelWall(336,112);SteelWall(320,128);SteelWall(336,128);SteelWall(416,144);SteelWall(432,144);SteelWall(416,160);SteelWall(432,160);BrickWall(384,80);BrickWall(400,80);BrickWall(384,96);BrickWall(400,96);BrickWall(384,48);BrickWall(400,48);BrickWall(384,64);BrickWall(400,64);BrickWall(320,144);BrickWall(336,144);BrickWall(320,160);BrickWall(336,160);BrickWall(384,144);BrickWall(400,144);BrickWall(384,160);BrickWall(400,160);BrickWall(384,208);BrickWall(400,208);BrickWall(384,224);BrickWall(400,224);BrickWall(384,240);BrickWall(400,240);BrickWall(384,256);BrickWall(400,256);BrickWall(384,272);BrickWall(400,272);BrickWall(384,288);BrickWall(400,288);BrickWall(384,304);BrickWall(400,304);BrickWall(384,320);BrickWall(400,320);BrickWall(320,304);BrickWall(336,304);BrickWall(320,320);BrickWall(336,320);BrickWall(320,240);BrickWall(336,240);BrickWall(320,256);BrickWall(336,256);BrickWall(320,368);BrickWall(336,368);BrickWall(320,384);BrickWall(336,384);BrickWall(320,400);BrickWall(336,400);BrickWall(320,416);BrickWall(336,416);BrickWall(352,400);BrickWall(368,400);BrickWall(352,416);BrickWall(368,416);BrickWall(384,400);BrickWall(400,400);BrickWall(384,416);BrickWall(400,416);BrickWall(384,368);BrickWall(400,368);BrickWall(384,384);BrickWall(400,384);SteelWall(352,304);SteelWall(368,304);SteelWall(352,320);SteelWall(368,320);Trees(352,208);Trees(352,176);Trees(352,144)",
  tanks: [
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
  ]
});;

// Stage 3
Globals.stages.push({
  map: "Base(224,400);SteelWall(208,416);SteelWall(208,400);SteelWall(208,384);SteelWall(224,384);SteelWall(240,384);SteelWall(256,384);SteelWall(256,400);SteelWall(256,416);BrickWall(32,80);BrickWall(48,80);BrickWall(32,96);BrickWall(48,96);Trees(64,48);Trees(64,80);Trees(96,80);Trees(96,48);Trees(128,48);Trees(128,80);Trees(128,112);Trees(96,112);Trees(64,112);Trees(32,112);Trees(32,144);Trees(64,144);Trees(96,144);Trees(128,144);Trees(128,176);Trees(96,176);Trees(64,176);Trees(32,176);Trees(64,208);BrickWall(64,256);BrickWall(80,256);BrickWall(64,272);BrickWall(64,288);BrickWall(32,272);BrickWall(48,272);BrickWall(32,288);BrickWall(48,288);BrickWall(112,272);BrickWall(112,288);BrickWall(128,256);BrickWall(144,256);BrickWall(160,272);BrickWall(160,288);BrickWall(128,272);BrickWall(144,272);BrickWall(128,288);BrickWall(144,288);BrickWall(32,336);BrickWall(48,336);BrickWall(32,352);BrickWall(48,352);BrickWall(32,368);BrickWall(48,368);BrickWall(32,384);BrickWall(48,384);BrickWall(64,368);BrickWall(80,368);BrickWall(64,384);BrickWall(80,384);BrickWall(64,400);BrickWall(80,400);BrickWall(64,416);BrickWall(80,416);BrickWall(96,400);BrickWall(112,400);BrickWall(96,416);BrickWall(112,416);SteelWall(32,400);SteelWall(48,400);SteelWall(32,416);SteelWall(48,416);SteelWall(128,368);SteelWall(128,384);SteelWall(128,336);SteelWall(128,352);BrickWall(208,272);BrickWall(208,288);BrickWall(224,272);BrickWall(240,272);BrickWall(256,272);BrickWall(272,272);BrickWall(288,272);BrickWall(304,272);BrickWall(192,304);BrickWall(208,304);BrickWall(192,320);BrickWall(208,320);BrickWall(256,320);BrickWall(272,320);BrickWall(288,320);BrickWall(304,320);BrickWall(256,336);BrickWall(272,336);BrickWall(288,336);BrickWall(304,336);BrickWall(320,400);BrickWall(336,400);BrickWall(320,416);BrickWall(336,416);Trees(320,368);Trees(352,368);Trees(384,368);Trees(384,336);Trees(352,336);Trees(320,336);Trees(320,304);Trees(352,304);Trees(384,304);Trees(416,304);Trees(416,272);Trees(384,272);Trees(352,272);Trees(320,272);Trees(320,240);Trees(352,240);Trees(416,240);Trees(384,240);Trees(384,208);SteelWall(288,208);SteelWall(304,208);SteelWall(288,224);SteelWall(304,224);SteelWall(256,208);SteelWall(272,208);SteelWall(256,224);SteelWall(272,224);SteelWall(224,208);SteelWall(240,208);SteelWall(224,224);SteelWall(240,224);BrickWall(224,176);BrickWall(240,176);BrickWall(224,192);BrickWall(240,192);BrickWall(224,144);BrickWall(240,144);BrickWall(224,160);BrickWall(240,160);BrickWall(192,144);BrickWall(208,144);BrickWall(192,160);BrickWall(208,160);BrickWall(160,144);BrickWall(176,144);BrickWall(160,160);BrickWall(176,160);BrickWall(256,112);BrickWall(272,112);BrickWall(256,128);BrickWall(272,128);BrickWall(256,144);BrickWall(272,144);BrickWall(320,144);BrickWall(336,144);BrickWall(320,160);BrickWall(336,160);BrickWall(320,112);BrickWall(336,112);BrickWall(320,128);BrickWall(336,128);BrickWall(352,112);BrickWall(368,112);BrickWall(352,128);BrickWall(368,128);BrickWall(384,112);BrickWall(400,112);BrickWall(384,128);BrickWall(400,128);BrickWall(416,112);BrickWall(416,128);BrickWall(400,144);BrickWall(400,160);BrickWall(400,176);BrickWall(400,192);BrickWall(288,16);BrickWall(304,16);BrickWall(288,32);BrickWall(304,32);BrickWall(160,16);BrickWall(176,16);BrickWall(160,32);BrickWall(176,32);BrickWall(160,48);BrickWall(176,48);BrickWall(160,64);BrickWall(176,64);SteelWall(416,64);SteelWall(432,64);SteelWall(384,64);SteelWall(400,64);SteelWall(352,64);SteelWall(368,64)",
  tanks: [
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
  ]
});;

// Stage 4
Globals.stages.push({
  map: "Base(224,400);SteelWall(208,416);SteelWall(208,400);SteelWall(208,384);SteelWall(224,384);SteelWall(240,384);SteelWall(256,384);SteelWall(256,400);SteelWall(256,416);Trees(64,16);Trees(96,16);Trees(64,48);Trees(32,48);Trees(32,80);SteelWall(32,112);SteelWall(48,112);Water(32,176);SteelWall(32,400);SteelWall(48,400);SteelWall(32,416);SteelWall(48,416);Trees(64,400);Trees(32,368);BrickWall(64,336);BrickWall(80,336);BrickWall(64,352);BrickWall(80,352);BrickWall(96,336);BrickWall(112,336);BrickWall(96,352);BrickWall(112,352);BrickWall(96,368);BrickWall(112,368);BrickWall(128,368);BrickWall(144,368);BrickWall(128,352);BrickWall(144,352);BrickWall(64,304);BrickWall(80,304);BrickWall(96,304);BrickWall(112,304);BrickWall(160,336);BrickWall(176,336);BrickWall(256,336);BrickWall(272,336);BrickWall(192,336);BrickWall(208,336);BrickWall(192,352);BrickWall(208,352);BrickWall(224,336);BrickWall(240,336);BrickWall(224,352);BrickWall(240,352);BrickWall(128,304);BrickWall(144,304);BrickWall(128,320);BrickWall(144,320);BrickWall(160,304);BrickWall(176,304);BrickWall(160,320);BrickWall(176,320);BrickWall(192,304);BrickWall(208,304);BrickWall(192,320);BrickWall(208,320);BrickWall(224,304);BrickWall(240,304);BrickWall(224,320);BrickWall(240,320);BrickWall(256,304);BrickWall(272,304);BrickWall(256,320);BrickWall(272,320);BrickWall(288,304);BrickWall(304,304);BrickWall(288,320);BrickWall(304,320);BrickWall(80,272);BrickWall(80,288);BrickWall(96,240);BrickWall(112,240);BrickWall(96,256);BrickWall(112,256);BrickWall(96,208);BrickWall(112,208);BrickWall(96,224);BrickWall(112,224);BrickWall(112,176);BrickWall(112,192);BrickWall(112,144);BrickWall(112,160);BrickWall(128,144);BrickWall(144,144);BrickWall(128,112);BrickWall(144,112);BrickWall(128,128);BrickWall(144,128);BrickWall(160,112);BrickWall(176,112);BrickWall(160,128);BrickWall(176,128);BrickWall(192,112);BrickWall(208,112);BrickWall(192,128);BrickWall(208,128);BrickWall(224,112);BrickWall(240,112);BrickWall(224,128);BrickWall(240,128);BrickWall(256,112);BrickWall(272,112);BrickWall(256,128);BrickWall(272,128);BrickWall(288,112);BrickWall(304,112);BrickWall(288,128);BrickWall(304,128);BrickWall(320,112);BrickWall(336,112);BrickWall(320,128);BrickWall(336,128);BrickWall(352,112);BrickWall(368,112);BrickWall(352,128);BrickWall(368,128);BrickWall(384,112);BrickWall(384,128);BrickWall(384,144);BrickWall(384,160);BrickWall(320,176);BrickWall(320,192);BrickWall(320,208);BrickWall(320,224);BrickWall(352,272);BrickWall(352,288);BrickWall(352,304);BrickWall(368,304);BrickWall(320,304);BrickWall(336,304);BrickWall(320,336);BrickWall(336,336);BrickWall(320,352);BrickWall(336,352);BrickWall(352,336);BrickWall(368,336);BrickWall(352,352);BrickWall(368,352);BrickWall(320,368);BrickWall(336,368);BrickWall(288,368);BrickWall(304,368);BrickWall(288,352);BrickWall(304,352);BrickWall(320,272);BrickWall(336,272);BrickWall(320,288);BrickWall(336,288);BrickWall(288,272);BrickWall(304,272);BrickWall(288,288);BrickWall(304,288);BrickWall(256,272);BrickWall(272,272);BrickWall(256,288);BrickWall(272,288);BrickWall(224,272);BrickWall(240,272);BrickWall(224,288);BrickWall(240,288);BrickWall(192,272);BrickWall(208,272);BrickWall(192,288);BrickWall(208,288);BrickWall(160,272);BrickWall(176,272);BrickWall(160,288);BrickWall(176,288);BrickWall(128,272);BrickWall(144,272);BrickWall(128,288);BrickWall(144,288);BrickWall(96,272);BrickWall(112,272);BrickWall(96,288);BrickWall(112,288);BrickWall(128,240);BrickWall(144,240);BrickWall(128,256);BrickWall(144,256);BrickWall(160,240);BrickWall(176,240);BrickWall(160,256);BrickWall(176,256);BrickWall(192,240);BrickWall(208,240);BrickWall(192,256);BrickWall(208,256);BrickWall(224,240);BrickWall(240,240);BrickWall(224,256);BrickWall(240,256);BrickWall(256,240);BrickWall(272,240);BrickWall(256,256);BrickWall(272,256);BrickWall(288,240);BrickWall(304,240);BrickWall(288,256);BrickWall(304,256);BrickWall(320,240);BrickWall(336,240);BrickWall(320,256);BrickWall(336,256);BrickWall(288,208);BrickWall(304,208);BrickWall(288,224);BrickWall(304,224);BrickWall(288,176);BrickWall(304,176);BrickWall(288,192);BrickWall(304,192);BrickWall(288,144);BrickWall(304,144);BrickWall(288,160);BrickWall(304,160);BrickWall(320,144);BrickWall(336,144);BrickWall(320,160);BrickWall(336,160);BrickWall(256,144);BrickWall(272,144);BrickWall(160,224);BrickWall(176,224);BrickWall(192,224);BrickWall(208,224);SteelWall(160,176);SteelWall(160,192);SteelWall(224,176);SteelWall(224,192);BrickWall(144,80);BrickWall(144,96);BrickWall(160,64);BrickWall(176,64);BrickWall(256,64);BrickWall(272,64);BrickWall(288,64);BrickWall(304,64);BrickWall(352,96);BrickWall(368,96);BrickWall(320,80);BrickWall(336,80);BrickWall(320,96);BrickWall(336,96);BrickWall(288,80);BrickWall(304,80);BrickWall(288,96);BrickWall(304,96);BrickWall(256,80);BrickWall(272,80);BrickWall(256,96);BrickWall(272,96);BrickWall(224,80);BrickWall(240,80);BrickWall(224,96);BrickWall(240,96);BrickWall(192,80);BrickWall(208,80);BrickWall(192,96);BrickWall(208,96);BrickWall(160,80);BrickWall(176,80);BrickWall(160,96);BrickWall(176,96);BrickWall(192,48);BrickWall(208,48);BrickWall(192,64);BrickWall(208,64);BrickWall(224,48);BrickWall(240,48);BrickWall(224,64);BrickWall(240,64);SteelWall(416,80);SteelWall(432,80);SteelWall(416,400);SteelWall(432,400);SteelWall(416,416);SteelWall(432,416);Trees(416,368);Trees(384,368);Trees(352,400);Trees(384,400);Trees(416,336);Trees(416,48);Trees(384,16);Water(416,208);Water(384,208)",
  tanks: [
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
    Tank.Type.BASIC,
  ]
});;

//StageStatisticsScene
function StageStatisticsScene(sceneManager, stage, player, gameOver) {
  var self = this;
  
  this._sceneManager = sceneManager;
  this._stage = stage;
  this._player = player;
  this._gameOver = gameOver;
  
  this._script = new Script();
  
  this._basicTankPoints = new StageStatisticsPoints(100, this._player.getTanks(Tank.Type.BASIC), this._script);
  this._drawTotal = false;
  
  this._script.enqueue(new Delay(this._script, 30));
  this._script.enqueue({execute: function () { self._basicTankPoints.show(); }});
  this._script.enqueue(this._basicTankPoints);
  this._script.enqueue({execute: function () { self._drawTotal = true; }});
  this._script.enqueue(new Delay(this._script, 60));
  this._script.enqueue({execute: function () {
    self._player.resetTanks();
    if (gameOver) {
      var script = new Script();
      Delay(script, 60);
      window.self.location = "rank.html";
    }
    else {
      sceneManager.toGameScene(stage + 1, player);
    }
  }});
};

StageStatisticsScene.prototype.update = function () {
  this._script.update();
};

StageStatisticsScene.prototype.draw = function (ctx) {
  ctx.fillStyle = "#000000";
  ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);
  
  ctx.fillStyle = "#feac4e";
  ctx.fillText("20000", 306, 46);
  
  ctx.fillStyle = "#ffffff";
  ctx.fillText("STAGE " + ("" + this._stage).lpad(" ", 2), 194, 78);
  
  ctx.drawImage(ImageManager.getImage('roman_one_red'), 52, 96);
  
  ctx.fillStyle = "#e44437";
  ctx.fillText("-PLAYER", 66, 110);
  
  ctx.fillStyle = "#feac4e";
  ctx.fillText(("" + this._player.getScore()).lpad(" ", 7), 66, 142);
  
  ctx.fillStyle = "#ffffff";
  
  ctx.fillText("PTS", 130, 190);
  this._basicTankPoints.draw(ctx, 34, 190);
  ctx.drawImage(ImageManager.getImage('tank_basic_up_c0_t1'), 241, 169);
  ctx.drawImage(ImageManager.getImage('arrow'), 226, 176);
  
  ctx.fillText("TOTAL", 100, 366);
  ctx.drawImage(ImageManager.getImage('white_line'), 192, 346);
  if (this._drawTotal) {
    ctx.fillText(("" + this._player.getTanksCount()).lpad(" ", 2), 194, 366);
  }
};

//å³å¡åæ°ç»è®¡
function StageStatisticsPoints(value, count, listener) {
  var self = this;
  
  this._value = value;
  this._count = count;
  this._counter = count > 0 ? 1 : 0;
  this._visible = false;
  this._listener = listener;
  
  this._script = new Script();
  this._script.enqueue(new Delay(this._script, 15));
  for (var i = 1; i < this._count; ++i) {
    this._script.enqueue({execute: function () {
      self._counter++;
      SoundManager.play("statistics_1");
    }});
    this._script.enqueue(new Delay(this._script, 10));
  }
  this._script.enqueue(new Delay(this._script, 15));
  this._script.enqueue({execute: function () { self._listener.actionCompleted(); }});
}

StageStatisticsPoints.prototype.update = function () {
  this._script.update();
};

StageStatisticsPoints.prototype.draw = function (ctx, x, y) {
  if (!this._visible) {
    return;
  }
  ctx.fillStyle = "#ffffff";
  var str = ("" + this._counter * this._value).lpad(" ", 5);
  str += "     ";
  str += ("" + this._counter).lpad(" ", 2);
  ctx.fillText(str, x, y);
};

StageStatisticsPoints.prototype.show = function () {
  this._visible = true;
};