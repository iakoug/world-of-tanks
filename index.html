<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta content="text/html; charset = utf-8">
  <title>Battle City</title>
  
  <link rel="stylesheet" href="css/BattleCity.css" />
  
  <script src="lib/jquery-3.1.0.min.js"></script>
  <script src="src/baseclass.js"></script>
  <script src="src/eventmanage.js"></script>
  <script src="src/keyboard.js"></script>
  <script src="src/sprite.js"></script>
  <script src="src/tank.js"></script>
  <script src="src/wall.js"></script>
  <script src="src/bullet.js"></script>
  <script src="src/explosion.js"></script>
  <script src="src/stage.js"></script>
  <script src="src/ai.js"></script>
  <script src="src/scene.js"></script>
  <script src="src/player.js"></script>
  <script src="src/app.js"></script>
  <script src="src/load.js"></script>
  <script>
    $(function () {
      var FPS = 50;
      
      var CANVAS_ID = 'canvas';
      var ctx = createCanvasContext();
      ctx.font = "16px prstart"
      
      var eventManager = new EventManager();
      var keyboard = new Keyboard(eventManager);
      var sceneManager = new SceneManager(eventManager);
      var script = new Script();
      Delay(script, 20);
      sceneManager.toMainMenuScene();
      
      setInterval(gameLoop, 1000 / FPS);
      
      function gameLoop() {
        keyboard.fireEvents();
        sceneManager.update();
        sceneManager.draw(ctx);
      }
      
      function createCanvasContext() {
        // 向maindiv中插入canvas标签
        $('<canvas id="' + CANVAS_ID + '" width="' + Globals.CANVAS_WIDTH + '" height="' + Globals.CANVAS_HEIGHT + '"></canvas>').prependTo('#main');
        var canvas = document.getElementById(CANVAS_ID);
        return canvas.getContext('2d');
      };
    });
  </script>

</head>

<body>
  <div id="main">
  </div>
</body>
</html>